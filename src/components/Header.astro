---
import logoUrl from '../assets/logo.png?url';
const base = import.meta.env.BASE_URL;
const baseWithSlash = base.endsWith('/') ? base : base + '/';
const normalizedBase = base.endsWith('/') ? base.slice(0, -1) : base;
const path = Astro.url.pathname;
const currentPath = path.startsWith(normalizedBase) ? (path.slice(normalizedBase.length) || '/') : path;
---

<header class="sticky top-0 z-50 w-full border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60">
  <div class="container mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex h-16 items-center justify-between">
      <!-- Logo -->
      <div class="flex items-center space-x-2">
        <a href={baseWithSlash} class="flex items-center space-x-2">
          <img src={logoUrl} alt="FlowVoco Logo" class="h-8 w-8 rounded-lg" />
          <span class="font-bold text-xl">FlowVoco</span>
        </a>
      </div>

      <!-- Desktop Navigation -->
      <nav class="hidden md:flex items-center space-x-6">
        <a href={baseWithSlash} class={`text-sm font-medium transition-colors hover:text-primary ${currentPath === '/' ? 'text-primary' : 'text-muted-foreground'}`}>
          首页
        </a>
        <a href={`${baseWithSlash}zh-cn/privacy`} class={`text-sm font-medium transition-colors hover:text-primary ${currentPath.includes('/privacy') ? 'text-primary' : 'text-muted-foreground'}`}>
          隐私政策
        </a>
        <a href={`${baseWithSlash}zh-cn/terms`} class={`text-sm font-medium transition-colors hover:text-primary ${currentPath.includes('/terms') ? 'text-primary' : 'text-muted-foreground'}`}>
          服务条款
        </a>
        <div class="flex items-center space-x-2">
          <a href={`${baseWithSlash}zh-cn/privacy`} class="text-sm text-muted-foreground hover:text-primary">中文</a>
          <span class="text-muted-foreground">|</span>
          <a href={`${baseWithSlash}zh-tw/privacy`} class="text-sm text-muted-foreground hover:text-primary">繁體中文</a>
          <span class="text-muted-foreground">|</span>
          <a href={`${baseWithSlash}en-us/privacy`} class="text-sm text-muted-foreground hover:text-primary">English</a>
        </div>
      </nav>

      <!-- Mobile menu button -->
      <button class="md:hidden" id="mobile-menu-button" aria-label="Toggle menu">
        <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
      </button>
    </div>

    <!-- Mobile Navigation -->
    <div class="md:hidden hidden" id="mobile-menu">
      <div class="py-4 space-y-4 border-t">
        <a href={baseWithSlash} class={`block text-sm font-medium transition-colors hover:text-primary ${currentPath === '/' ? 'text-primary' : 'text-muted-foreground'}`}>
          首页
        </a>
        <a href={`${baseWithSlash}zh-cn/privacy`} class={`block text-sm font-medium transition-colors hover:text-primary ${currentPath.includes('/privacy') ? 'text-primary' : 'text-muted-foreground'}`}>
          隐私政策
        </a>
        <a href={`${baseWithSlash}zh-cn/terms`} class={`block text-sm font-medium transition-colors hover:text-primary ${currentPath.includes('/terms') ? 'text-primary' : 'text-muted-foreground'}`}>
          服务条款
        </a>
        <div class="pt-4 border-t">
          <div class="flex items-center space-x-4">
            <a href={`${baseWithSlash}zh-cn/privacy`} class="text-sm text-muted-foreground hover:text-primary">中文</a>
            <a href={`${baseWithSlash}zh-tw/privacy`} class="text-sm text-muted-foreground hover:text-primary">繁體中文</a>
            <a href={`${baseWithSlash}en-us/privacy`} class="text-sm text-muted-foreground hover:text-primary">English</a>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>

<script>
  const mobileMenuButton = document.getElementById('mobile-menu-button');
  const mobileMenu = document.getElementById('mobile-menu');

  if (mobileMenuButton && mobileMenu) {
    mobileMenuButton.addEventListener('click', () => {
      mobileMenu.classList.toggle('hidden');
    });
  }
</script>
